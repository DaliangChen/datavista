
è¾“å‡ºç»“æœï¼š

```
city      Beijing  Shanghai
date
2024-01         5         8
2024-02         7        10
```

è§£é‡Šï¼š

* `index="date"`ï¼šæŒ‰æœˆä»½æ’åˆ—è¡Œï¼›
* `columns="city"`ï¼šå°† `city` ä¸­çš„å”¯ä¸€å€¼ï¼ˆBeijingã€Shanghaiï¼‰è½¬æˆåˆ—ï¼›
* `values="temperature"`ï¼šå¡«å…¥è¡¨æ ¼ä¸­çš„æ•°å€¼ã€‚

---

**ğŸ§¨ æ³¨æ„äº‹é¡¹ï¼šä¸èƒ½æœ‰é‡å¤é¡¹ï¼**

å¦‚æœæ•°æ®ä¸­å‡ºç° `index + columns` çš„ç»„åˆé‡å¤ï¼Œ`pivot()` ä¼šæŠ¥é”™ï¼š

```python
ValueError: Index contains duplicate entries, cannot reshape
```

è§£å†³æ–¹æ³•ï¼šä½¿ç”¨ `pivot_table()` æ›¿ä»£ï¼ˆå®ƒæ”¯æŒèšåˆï¼‰ã€‚

---

**ğŸ” pivot vs pivot\_table**

| æ–¹æ³•            | æ˜¯å¦æ”¯æŒé‡å¤é¡¹ | æ˜¯å¦æ”¯æŒèšåˆ | é»˜è®¤èšåˆå‡½æ•°     |
| ------------- | ------- | ------ | ---------- |
| `pivot`       | âŒ ä¸æ”¯æŒ   | âŒ ä¸æ”¯æŒ  | æ—           |
| `pivot_table` | âœ… æ”¯æŒ    | âœ… æ”¯æŒ   | `mean`ï¼ˆå¯æ”¹ï¼‰ |

ä¾‹å¦‚ï¼š

```python
df.pivot_table(index="date", columns="city", values="temperature", aggfunc="mean")
```

---

**ğŸ”„ åå‘æ“ä½œï¼š`melt`**

å¦‚æœä½ ä½¿ç”¨äº† `pivot` è®©æ•°æ®å˜å®½ï¼Œæƒ³æ¢å¤æˆé•¿æ ¼å¼ï¼Œå¯ä»¥ç”¨ `melt`ï¼š

```python
df_pivot.reset_index().melt(id_vars="date", value_name="temperature")
```

---

**ğŸ§  æ€»ç»“**

| åŠŸèƒ½            | æè¿°                               |
| ------------- | -------------------------------- |
| `pivot`       | æŒ‰ index/columns é‡æ’è¡¨æ ¼ï¼›å¿…é¡»æ— é‡å¤ï¼›åªç”¨äºé‡æ„ |
| `pivot_table` | åŒä¸Šï¼Œä½†å…è®¸é‡å¤å¹¶èƒ½èšåˆ                     |
| `melt`        | æŠŠå®½è¡¨â€œè¿˜åŸâ€ä¸ºé•¿è¡¨                       |

---

å¦‚æœä½ æœ‰å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚è´¢åŠ¡è¡¨ã€é”€å”®æŠ¥è¡¨ã€è€ƒå‹¤æ•°æ®ç­‰ï¼Œæˆ‘å¯ä»¥ç»™å‡ºå¯¹åº”çš„ `pivot` å®æˆ˜æ¡ˆä¾‹ã€‚éœ€è¦å—ï¼Ÿ
