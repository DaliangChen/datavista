📌 使用场景

Multi-task Elastic Net 适用于：

- 多输出回归问题：即同时预测多个相关的连续目标变量。
- 你希望模型能：

  - 在多个任务间共享特征选择（即一组任务使用相同特征子集）
  - 同时兼顾特征选择（L1）和鲁棒性（L2）

- 特征之间具有一定相关性，且多个输出任务之间也可能相关。
- 想避免 Lasso 过于稀疏或不稳定的情况，又不想完全放弃特征选择能力。

典型应用：

- 同时预测多个健康指标、财务指标或图像特征
- 高维多任务学习场景（例如基因组数据的多个表型预测）

📌 基本原理

Multi-task Elastic Net 是 Multi-task Lasso 的扩展，结合了：

- 多任务特征选择能力（通过 group L1 正则）
- Ridge 的鲁棒性（通过 L2 正则）

目标函数为：

$$
\min_W \frac{1}{2n} \|Y - XW\|_F^2 + \alpha \left( \rho \sum_{j=1}^p \|W_{j, :}\|_1 + \frac{1 - \rho}{2} \|W\|_F^2 \right)
$$

- $X \in \mathbb{R}^{n \times p}$：输入特征
- $Y \in \mathbb{R}^{n \times T}$：多输出目标
- $W \in \mathbb{R}^{p \times T}$：待学习的系数矩阵
- 第一项：预测误差（Frobenius 范数）
- 第二项：L1 和 L2 的组合正则项
- $\alpha$：正则化强度
- $\rho \in [0,1]$：控制 L1（稀疏）与 L2（平滑）的平衡

特点：

- 通过 group L1 对每个特征整行进行惩罚，实现跨任务的特征选择
- 加入 L2 提高模型的稳定性与泛化能力

📌 注意事项

1. 适用于多输出回归任务：

   - 若是单任务回归，使用普通 `ElasticNet` 即可。
   - 若不需要特征选择，可考虑多输出 Ridge。

2. 特征需标准化：

   - 因正则化项依赖于系数大小，未标准化会影响结果。

3. 相关特征与相关任务效果更佳：

   - 多任务弹性网在特征间或任务间有相关性时更能发挥优势。

4. 超参数调节重要：

   - 包含两个关键参数：

     - `alpha`: 控制整体正则强度
     - `l1_ratio (ρ)`: 控制 L1 与 L2 的比例

   - 推荐使用 `MultiTaskElasticNetCV` 自动选择最佳参数组合。

5. 不会过于稀疏也不会过于密集：

   - 比 Multi-task Lasso 更稳定、泛化能力更强；
   - 比 Multi-task Ridge 更具特征选择能力。
