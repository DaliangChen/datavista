📌 使用场景

Elastic Net 适用于：

- 数据具有高度相关的特征，不适合纯 Lasso（可能随机选择其中一部分）。
- 你希望在模型中同时实现：

  - 特征选择（像 Lasso）
  - 模型稳定性与鲁棒性（像 Ridge）

- 特征数大于样本数（高维场景）时，比 Lasso 更稳健。
- 需要处理冗余特征，又不想完全舍弃 L2 正则带来的好处。

典型应用：

- 基因表达分析（高维、相关性强）
- 金融指标预测（多个相关变量）
- 文本建模与变量筛选（稀疏数据）

📌 基本原理

Elastic Net 是 Lasso（L1 正则）和 Ridge（L2 正则）的结合体。

目标函数为：

$$
\min_\beta \|X\beta - y\|^2 + \alpha \left( \rho \|\beta\|_1 + \frac{1 - \rho}{2} \|\beta\|_2^2 \right)
$$

- 第一项是残差平方和。
- 第二项是 L1 + L2 正则混合项：

  - $\|\beta\|_1$：促使部分系数为 0（特征选择）
  - $\|\beta\|_2^2$：对系数进行收缩，提高稳定性

- 参数说明：

  - $\alpha$：整体正则化强度（越大越正则）
  - $\rho \in [0, 1]$：控制 L1 和 L2 的比例：

    - $\rho = 1$：等价于 Lasso
    - $\rho = 0$：等价于 Ridge

📌 注意事项

1. 适合特征高度相关的情况：

   - 纯 Lasso 会“随机”保留其中一个特征；
   - Elastic Net 倾向于保留一组相关特征，避免信息损失。

2. 超参数需调优：

   - 包含两个关键超参数：

     - `alpha`: 总正则化强度
     - `l1_ratio`: L1 和 L2 的混合比例

   - 推荐使用 `ElasticNetCV` 自动搜索最优组合（交叉验证）。

3. 特征应标准化：

   - 因为正则项依赖系数大小，特征量纲不统一会影响模型效果。
   - 建议使用 `StandardScaler` 或 `MinMaxScaler`。

4. 不会生成完全稀疏模型（除非 L1 成分较大）：

   - 与 Lasso 相比，Elastic Net 通常会保留更多非零系数。

5. 适用于高维、相关特征场景，稳健性优于 Lasso：

   - 在样本数远小于特征数（如文本、图像、基因组数据）时非常有效。
